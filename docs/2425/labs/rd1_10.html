<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Continuous random variables – DAPR1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-3e476e15ae565c222d94875412ae43a1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-d3043699f4f525e226433170f63674df.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-4823d056cc0a8309e077c97e601d5ea4.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-936f437bde601076d6706b684ef02b78.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-chevron-circle-right')) {
    f.classList.add('fa-chevron-circle-down')
    f.classList.remove('fa-chevron-circle-right')
} else {
    f.classList.add('fa-chevron-circle-right')
    f.classList.remove('fa-chevron-circle-down')
}
}
</script><script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="assets/styles.css">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR1</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lab-materials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lab Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lab-materials">
<li class="dropdown-header"><b>Block 1: Exploratory data analysis</b></li>
        <li>
    <a class="dropdown-item" href="./1_01_design_and_data.html">
 <span class="dropdown-text">S1-W1: Research design &amp; data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_02_categorical_data.html">
 <span class="dropdown-text">S1-W2: Categorical data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_03_numeric_data.html">
 <span class="dropdown-text">S1-W3: Numeric data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_04_relationships.html">
 <span class="dropdown-text">S1-W4: Relationships</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_05_formative_report_a.html">
 <span class="dropdown-text">S1-W5: Formative Report A</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header"><b>Block 2: Probability</b></li>
        <li>
    <a class="dropdown-item" href="./1_07_prob_theory.html">
 <span class="dropdown-text">S1-W7: Probability Theory</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_08_prob_rules.html">
 <span class="dropdown-text">S1-W8: Probability Rules</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_09_discrete_dist.html">
 <span class="dropdown-text">S1-W9: Discrete Random Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_10_cont_dist.html">
 <span class="dropdown-text">S1-W10: Continuous Random Variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./1_11_sampling.html">
 <span class="dropdown-text">S1-W11: Formative Report B</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header"><b>Block 3: Inference</b></li>
        <li>
    <a class="dropdown-item" href="./2_01_confint.html">
 <span class="dropdown-text">S2-W1: Confidence intervals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_02_ht_pvalues.html">
 <span class="dropdown-text">S2-W2: HT (p-values)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./2_03_ht_critvalues.html">
 <span class="dropdown-text">S2-W3: HT (critical values)</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-readings" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Readings</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-readings">
<li class="dropdown-header"><b>Block 1: Exploratory data analysis</b></li>
        <li>
    <a class="dropdown-item" href="./rd1_01.html">
 <span class="dropdown-text">S1-W1: Getting started with R and RStudio</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_02.html">
 <span class="dropdown-text">S1-W2: Categorical data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_03.html">
 <span class="dropdown-text">S1-W3: Numeric data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_04.html">
 <span class="dropdown-text">S1-W4: Relationships</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_05.html">
 <span class="dropdown-text">S1-W5: Functions</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header"><b>Block 2: Probability</b></li>
        <li>
    <a class="dropdown-item" href="./rd1_07.html">
 <span class="dropdown-text">S1-W7: Probability 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_08.html">
 <span class="dropdown-text">S1-W8: Probability 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_09.html">
 <span class="dropdown-text">S1-W9: Discrete random variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_10.html">
 <span class="dropdown-text">S1-W10: Continuous random variables</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd1_11.html">
 <span class="dropdown-text">S1-W11: Sampling</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header"><b>Block 3: Inference</b></li>
        <li>
    <a class="dropdown-item" href="./rd2_01.html">
 <span class="dropdown-text">S2-W1: Confidence intervals</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd2_02.html">
 <span class="dropdown-text">S2-W2: HT (p-values)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd2_03.html">
 <span class="dropdown-text">S2-W3: HT (critical values)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd2_04.html">
 <span class="dropdown-text">S2-W4: Connecting HT and CIs</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./rd2_05.html">
 <span class="dropdown-text">S2-W5: Errors, Power, Effect size, Assumptions</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link active" data-scroll-target="#continuous-random-variables"><span class="header-section-number">1</span> Continuous random variables</a></li>
  <li><a href="#proportions-as-areas-the-density-histogram" id="toc-proportions-as-areas-the-density-histogram" class="nav-link" data-scroll-target="#proportions-as-areas-the-density-histogram"><span class="header-section-number">2</span> Proportions as areas: the density histogram</a></li>
  <li><a href="#the-normal-distribution" id="toc-the-normal-distribution" class="nav-link" data-scroll-target="#the-normal-distribution"><span class="header-section-number">3</span> The normal distribution</a></li>
  <li><a href="#the-68-95-99.7-rule" id="toc-the-68-95-99.7-rule" class="nav-link" data-scroll-target="#the-68-95-99.7-rule"><span class="header-section-number">4</span> The 68-95-99.7% rule</a></li>
  <li>
<a href="#obtaining-probabilities" id="toc-obtaining-probabilities" class="nav-link" data-scroll-target="#obtaining-probabilities"><span class="header-section-number">5</span> Obtaining probabilities</a>
  <ul class="collapse">
<li><a href="#area-to-the-left-of-a-value-x" id="toc-area-to-the-left-of-a-value-x" class="nav-link" data-scroll-target="#area-to-the-left-of-a-value-x"><span class="header-section-number">5.1</span> 1. Area to the left of a value <span class="math inline">\(x\)</span></a></li>
  <li><a href="#area-between-the-values-x_l-and-x_u" id="toc-area-between-the-values-x_l-and-x_u" class="nav-link" data-scroll-target="#area-between-the-values-x_l-and-x_u"><span class="header-section-number">5.2</span> 2. Area between the values <span class="math inline">\(x_l\)</span> and <span class="math inline">\(x_u\)</span></a></li>
  <li><a href="#area-to-the-right-of-x" id="toc-area-to-the-right-of-x" class="nav-link" data-scroll-target="#area-to-the-right-of-x"><span class="header-section-number">5.3</span> 3. Area to the right of <span class="math inline">\(x\)</span></a></li>
  </ul>
</li>
  <li><a href="#the-inverse-problem-quantiles-and-percentiles" id="toc-the-inverse-problem-quantiles-and-percentiles" class="nav-link" data-scroll-target="#the-inverse-problem-quantiles-and-percentiles"><span class="header-section-number">6</span> The inverse problem: quantiles and percentiles</a></li>
  <li><a href="#working-in-standard-units" id="toc-working-in-standard-units" class="nav-link" data-scroll-target="#working-in-standard-units"><span class="header-section-number">7</span> Working in standard units</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">8</span> Summary</a></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary"><span class="header-section-number">9</span> Glossary</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Continuous random variables</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="continuous-random-variables" class="level2" data-number="1"><h2 data-number="1" class="anchored" data-anchor-id="continuous-random-variables">
<span class="header-section-number">1</span> Continuous random variables</h2>
<p>Recall that a random variable is continuous if there are no gaps between the possible values it can take.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/rvs_range.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Imagine a spinner numbered with the hours of the day. If you were to spin it with some strength, what’s the probability of the hand stopping <em>exactly</em> at 3.5173847294 hours?</p>
<p>Well, there is only one way to observe 3.5173847294, while there are an infinite number of possibilities between 0 and 24 hours (you could have as many decimals as you wish).</p>
<p>Define the event <span class="math inline">\(A = \{ 3.5173847294 \}\)</span>. If you were to calculate the probability of observing <span class="math inline">\(A\)</span> using the standard formula you would get: <span class="math display">\[
P(A) = \frac{n_A}{n} = \frac{1}{\infty} = 0
\]</span></p>
<p>The probability of the hand stopping <em>exactly</em> at 3.5173847294 hours is 0.</p>
<p>Check this with R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">1</span> <span class="op">/</span> <span class="cn">Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>For this reason, we cannot compute probabilities for continuous random variables in the same way as we did in the previous weeks (number of outcomes in the event / number of possible outcomes).</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key point</strong></p>
<p>For continuous random variables we can only compute the probability of observing a value <em><strong>in a given interval.</strong></em> For example, the probability that the hand stops in between 3 and 3.5 hours.</p>
</div>
</div>
</div>
<p>Consider the histogram shown below. The height of each rectangle will tell you the number of people having a value within a specific interval. For example, the number of people having a value of <span class="math inline">\(x\)</span> between 20 and 22.5.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="rd1_10_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="proportions-as-areas-the-density-histogram" class="level2" data-number="2"><h2 data-number="2" class="anchored" data-anchor-id="proportions-as-areas-the-density-histogram">
<span class="header-section-number">2</span> Proportions as areas: the density histogram</h2>
<p>The natural gestation period for human births has a mean of about 266 days and a standard deviation of about 16 days. A group of researchers recorded the gestation period (in days) of 10,000 babies and the distribution is shown below as a <em>frequency histogram</em> (left panel) and <em>relative frequency</em> histogram (right panel).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="rd1_10_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Frequency histogram (left panel) and relative frequency histogram (right panel) of gestation period.</figcaption></figure>
</div>
</div>
</div>
<p>The histogram is unimodal, with the modal interval extending from 266 to 270 days. The distribution is symmetric around the centre (266). This means that if you were the fold the histogram at 266 days, the two halves would match when superimposed.</p>
<p>The histogram also highlights some variability in gestation days from person to person, with some women giving birth after as low as 200 days or as high as 320 days.</p>
<p>Usually, histograms are drawn with the height of the rectangle for the <span class="math inline">\(j\)</span>th interval being either the frequency (count) <span class="math inline">\(n_j\)</span> or the relative frequency <span class="math inline">\(n_j / n\)</span> of observations falling into that interval.</p>
<p>For example, for roughly 400 women the gestation period was between 240 and 245 days. If we use the relative frequency, instead, the <em>height</em> of the rectangle tells us the proportion of observations in that interval. In this case, the proportion of women with a gestation period between 240 and 245 days is <span class="math inline">\(400 / 10,000 = 0.04\)</span>.</p>
<p>We now discuss a third type of histogram called the <em><strong>density histogram</strong></em>, in which we adjust the heigh of the rectangle so that the <em>area</em> is equal to the relative frequency. This is accomplished by changing the height to <span class="math inline">\(n_j / (n w)\)</span> where <span class="math inline">\(w\)</span> is the interval width.</p>
<p>Why does this work? <span class="math display">\[
area = width \cdot height = w \cdot \frac{n_j}{n w} = \frac{n_j}{n}
\]</span></p>
<p>So now it is the <em>area</em> of the <span class="math inline">\(j\)</span>th rectangle that tells us the proportion of observations in the <span class="math inline">\(j\)</span>th interval.</p>
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dens-hist-ab" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dens-hist-ab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rd1_10_files/figure-html/fig-dens-hist-ab-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dens-hist-ab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Density histogram of the gestation period for the 10,000 women in the study.
</figcaption></figure>
</div>
</div>
</div>
<p><br></p>
<p>In <a href="#fig-dens-hist-ab" class="quarto-xref">Figure&nbsp;1</a>(a) the proportion of women under study whose gestation period falls within any class interval is the area of the corresponding rectangle. For example the proportion of women with a gestation period between 240 and 245 days is equal to <span class="math inline">\(area = width \cdot height = 5 \cdot 0.008 = 0.04\)</span>, which matches the relative frequency histogram.</p>
<p>Furthermore, we can obtain the proportion of women whose gestation period falls between the limits <span class="math inline">\(a = 240\)</span> days and <span class="math inline">\(b = 255\)</span> days by adding the areas of all the rectangles between these limits. As the graph in <a href="#fig-dens-hist-ab" class="quarto-xref">Figure&nbsp;1</a>(b) tells us, the area of the shaded part is .196. Thus, the proportion of women with a gestation period between 240 and 255 days is 0.196 or 19.6% of the women in the study population.</p>
<p>This correspondence between area and proportions is the foundation on which the probability for continuous random variables is built. In fact, we can say that the probability that a randomly picked woman from the study population has a gestation period between 240 and 255 days is 0.196.</p>
<p>Also, note that the total area under a density histogram is <span class="math display">\[
\sum \left( \frac{n_j}{n w} \cdot w \right) = \frac{\sum  n_j}{n} = 1
\]</span></p>
<p><br></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Let’s now summarise what we have learned about <em><strong>density histograms</strong></em>:</p>
<ul>
<li><p>the vertical scale is <em><strong>relative frequency / interval width</strong></em></p></li>
<li><p>the total area under the histogram is 1</p></li>
<li><p>the <em><strong>proportion</strong></em> of data between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> is the <em><strong>area</strong></em> under the histogram between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span></p></li>
</ul>
</div>
</div>
</div>
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-dens-hist-cd" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-dens-hist-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rd1_10_files/figure-html/fig-dens-hist-cd-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dens-hist-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Density curve of the gestation period for the 10,000 women in the sample.
</figcaption></figure>
</div>
</div>
</div>
<p><br></p>
<p>In <a href="#fig-dens-hist-cd" class="quarto-xref">Figure&nbsp;2</a>(c) we have superimposed an approximating smooth curve on top of the density histogram. <a href="#fig-dens-hist-cd" class="quarto-xref">Figure&nbsp;2</a>(d) displays only the approximating smooth curve. Furthermore, we have also highlighted in green the area under that curve in between the same limit as the histogram (<span class="math inline">\(a = 240\)</span> and <span class="math inline">\(b = 255\)</span>) and calculated the highlighted area. That area turned out to be 0.194, which is very close to the area of 0.196 computed from the density histogram.</p>
<p>From this, it is quite easy to see how areas under the smooth curve in between two particular limits are in good agreement with the same areas computed using a density histogram, and thus with proportions of people in the study.</p>
<p>Such smooth curve is called a <em><strong>density curve</strong></em> or <em><strong>density function</strong></em>. The probability distribution of a continuous random variable <span class="math inline">\(X\)</span> is specified in terms of its density function. We calculate the probability that the random variable <span class="math inline">\(X\)</span> is between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> by finding the area under the density curve between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Let’s now summarise what we have learned about <em><strong>density functions</strong></em>:</p>
<ul>
<li><p>The probability distribution of a continuous random variable is specified in terms of a density function (i.e., a density curve).</p></li>
<li><p>Probabilities are obtained as areas under the density curve.</p></li>
<li>
<p>The total area under the curve is one.</p>
<p>This is because the total probability must be one: <span class="math inline">\(P(R_X) = 1\)</span>.</p>
</li>
<li>
<p>The curve is always greater than or equal to zero for all possible values of the random variable.</p>
<p>This is similar to saying that probabilities cannot be negative.</p>
</li>
</ul>
</div>
</div>
</div>
<p>Last week we said that the probability distribution of a random variable <span class="math inline">\(X\)</span> provides a concise representation of the random variable in terms of the set of all the possible values it can take and the corresponding probabilities. Clearly, this gives an immediate global picture of the random variable.</p>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Probability distribution for a continuous random variable</strong></p>
<p>The <em><strong>probability distribution</strong></em> of a continuous random variable <span class="math inline">\(X\)</span> provides the possible values of the random variable and their corresponding <em><strong>probability densities</strong></em>.</p>
<p>A probability distribution can be in the form of a graph or mathematical formula.</p>
</div>
</div>
</div>
<p>The density curve is the graphical representation of the probability distribution, while the density function is the mathematical formula of the curve.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Help! I am slightly lost…
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To revise the following topics click on the links below:</p>
<ul>
<li><p>Semester 1, Week 2: <a href="rd1_02.html">Frequency distributions</a></p></li>
<li><p>Semester 1, Week 3: <a href="rd1_03.html">Histograms and densities</a></p></li>
</ul>
</div>
</div>
</div>
<!-- # Probabilities and density curves -->
<!-- We are now going to take one step further. Think of the density function as a _model_ for the random process generating sample data on a continuous variable $X$, such as gestation period, in which the probability distribution is described by that smooth curve. -->
<!-- ```{r, echo=FALSE, fig.height = 8, out.width='90%'} -->
<!-- plot_dens <- function(n, b) { -->
<!--     df <- tibble( -->
<!--         y = rnorm(n, 100, 16) -->
<!--     ) -->
<!--     plt <- ggplot(df, aes(x = y)) + -->
<!--         geom_histogram(aes(y = ..density..),  -->
<!--                        fill = 'gray',color = 'white', bins = b) + -->
<!--         geom_function(fun = dnorm, args = list(mean = 100, sd = 16)) +  -->
<!--         theme_minimal() + -->
<!--         labs(x = 'IQ score', y = 'Density', -->
<!--              title = sprintf('%d observations, %d class intervals', n, b)) -->
<!--     return(plt) -->
<!-- } -->
<!-- (plot_dens(300, 30) | plot_dens(300, 70)) / -->
<!--     (plot_dens(300, 30) | plot_dens(300, 70)) / -->
<!--     (plot_dens(5000, 30) | plot_dens(5000, 70)) / -->
<!--     (plot_dens(100000, 30) | plot_dens(500000, 70)) -->
<!-- ``` -->
<!-- The distribution generating data on a continuous variable is described by a smooth curve called a density function. -->
<!-- Probabilities are represented by areas under the curve. -->
<!-- The total area under the curve is 1. -->
<!-- It takes very large sample sizes before the regularity of the underlying curve is reliably reflected in histograms of data from the distribution. -->
<!-- In the _long_ run, randomness will even out "noise" and show us the true density curve of the data. -->
</section><section id="the-normal-distribution" class="level2" data-number="3"><h2 data-number="3" class="anchored" data-anchor-id="the-normal-distribution">
<span class="header-section-number">3</span> The normal distribution</h2>
<p>A symmetric and bell-shaped density curve is called a <em><strong>normal</strong></em> density curve.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Normal distribution</strong></p>
<p>A continuous random variable is said to be <em><strong>normally distributed</strong></em>, or to have a <em><strong>normal probability distribution</strong></em>, if its distribution has the shape of a normal curve (it is symmetric and bell-shaped).</p>
</div>
</div>
</div>
<p>The normal density function is the function used to calculate probabilities (as areas under the density curve) for a normally distributed random variable.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Key question</strong></p>
<p>How can we make sure that the normal curve can adapt to any symmetric and bell-shaped density histogram?</p>
</div>
</div>
</div>
<p>Every histogram can be centred at a different value and have a different spread. Hence, we need to specify:</p>
<ol type="1">
<li>where the normal curve should be centred at;</li>
<li>what should the spread of the normal curve be.</li>
</ol>
<p>From this we can see that the normal curve depends on two quantities called the <em><strong>parameters</strong></em> of the normal distribution (see <a href="#fig-normal-vary-params" class="quarto-xref">Figure&nbsp;3</a>):</p>
<ol type="1">
<li>the mean <span class="math inline">\(\mu\)</span>, specifying the centre of the distribution;</li>
<li>the standard deviation <span class="math inline">\(\sigma\)</span>, specifying the spread of the distribution.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-normal-vary-params" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-vary-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="rd1_10_files/figure-html/fig-normal-vary-params-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-vary-params-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Normal curves for different means and standard deviations.
</figcaption></figure>
</div>
</div>
</div>
<p>As we can see, changing <span class="math inline">\(\mu\)</span> shifts the curve along the axis, while increasing <span class="math inline">\(\sigma\)</span> increases the spread and flattens the curve.</p>
<p>The formula for the normal density curve which we plotted above is provided below. However, you do not have to memorise it as this is already implemented in R: <span class="math display">\[
f(x) = \frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(x - \mu)^2}{2 \sigma^2}}
\]</span> for some values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>The same function in R is:</p>
<pre><code>dnorm(x, mean = &lt;mean&gt;, sd = &lt;sd&gt;)</code></pre>
<p>where:</p>
<ul>
<li>
<code>x</code> represents the value of the random variable</li>
<li>
<code>mean</code> the mean of the normal curve</li>
<li>
<code>sd</code> the standard deviation of the curve</li>
</ul>
<p>We write that a random variable <span class="math inline">\(X\)</span> <em>follows</em> a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> as <span class="math display">\[
X \sim N(\mu, \sigma)
\]</span></p>
<p>Clearly, the mean and standard deviation of <span class="math inline">\(X\)</span> will be <span class="math inline">\(E(X) = \mu\)</span> and <span class="math inline">\(SD(X) = \sigma\)</span> respectively.</p>
<p>We use lowercase letters such as <span class="math inline">\(x, a, b\)</span> to denote an observed value, or a particular value, of the random variable <span class="math inline">\(X\)</span>.</p>
</section><section id="the-68-95-99.7-rule" class="level2" data-number="4"><h2 data-number="4" class="anchored" data-anchor-id="the-68-95-99.7-rule">
<span class="header-section-number">4</span> The 68-95-99.7% rule</h2>
<p>A variable which is normally distributed has:</p>
<ul>
<li><p>68% of the observations (values) within <span class="math inline">\(1\sigma\)</span> of the <span class="math inline">\(\mu\)</span></p></li>
<li><p>95% of its observations (values) within <span class="math inline">\(2\sigma\)</span> of the <span class="math inline">\(\mu\)</span></p></li>
<li><p>99.7% of its observations (values) within <span class="math inline">\(3\sigma\)</span> of the <span class="math inline">\(\mu\)</span></p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/normal_rule.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="obtaining-probabilities" class="level2" data-number="5"><h2 data-number="5" class="anchored" data-anchor-id="obtaining-probabilities">
<span class="header-section-number">5</span> Obtaining probabilities</h2>
<p>Before describing how to compute the probabilities for a continuous random variable using R, we need to discuss an important property that only holds for <em>continuous</em> random variables:</p>
<div class="callout callout-style-simple callout-caution">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Interval endpoints for continuous random variables</strong></p>
<p>When performing calculations involving a <em>continuous</em> random variable, we do not have to worry about whether interval endpoints are included or not in the calculation: <span class="math display">\[
P(a \leq X \leq b) = P(a \leq X &lt; b) = P(a &lt; X \leq b) = P(a &lt; X &lt; b)
\]</span></p>
<p>This is due to the fact that the probability of <span class="math inline">\(X\)</span> being equal to a specific value is 0: <span class="math display">\[
\begin{aligned}
P(X \leq x) &amp;= P(X &lt; x) + P(X = x) \\
&amp;= P(X &lt; x) + 0 \\
&amp;= P(X &lt; x)
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<p>We compute areas under the normal curve using the function <code>pnorm(x, mean, sd)</code>. This returns the area to the left of <code>x</code> in a normal curve centred at <code>mean</code> and having standard deviation <code>sd</code>: <span class="math display">\[
P(X \leq x) = P(X &lt; x) = \texttt{pnorm}(x, \texttt{ mean = } \mu, \texttt{ sd = } \sigma)
\]</span></p>
<p>The following figure shows the type of areas returned by the <code>pnorm</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/normal_pnorm.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>R computes lower-tail probabilities.</figcaption></figure>
</div>
</div>
</div>
<p>For example, the probability that the random variable <span class="math inline">\(X \sim N(\mu = 5, \sigma = 2)\)</span> is less than 1 is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02275013</code></pre>
</div>
</div>
<p><br></p>
<p>There are three types of probabilities that we might want to compute:</p>
<ol type="1">
<li><p>The probability that <span class="math inline">\(X\)</span> is less than a given value: <span class="math inline">\(P(X &lt; x)\)</span></p></li>
<li><p>The probability that <span class="math inline">\(X\)</span> is between a lower and an upper value: <span class="math inline">\(P(x_l &lt; X &lt; x_u)\)</span></p></li>
<li><p>The probability that <span class="math inline">\(X\)</span> is greater than a given value: <span class="math inline">\(P(X &gt; x)\)</span></p></li>
</ol>
<p>We will now analyse each case in turn and show how each of these is computed.</p>
<section id="area-to-the-left-of-a-value-x" class="level3" data-number="5.1"><h3 data-number="5.1" class="anchored" data-anchor-id="area-to-the-left-of-a-value-x">
<span class="header-section-number">5.1</span> 1. Area to the left of a value <span class="math inline">\(x\)</span>
</h3>
<p>The probability that <span class="math inline">\(X &lt; x\)</span> is directly returned by <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/pnorm_left.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="area-between-the-values-x_l-and-x_u" class="level3" data-number="5.2"><h3 data-number="5.2" class="anchored" data-anchor-id="area-between-the-values-x_l-and-x_u">
<span class="header-section-number">5.2</span> 2. Area between the values <span class="math inline">\(x_l\)</span> and <span class="math inline">\(x_u\)</span>
</h3>
<p>The probability that <span class="math inline">\(X\)</span> is between a lower (<span class="math inline">\(x_l\)</span>) and an upper (<span class="math inline">\(x_u\)</span>) value can be obtained as: <span class="math display">\[
P(x_l &lt; X &lt; x_u) = P(X &lt; x_u) - P(X &lt; x_l)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/pnorm_interval.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="area-to-the-right-of-x" class="level3" data-number="5.3"><h3 data-number="5.3" class="anchored" data-anchor-id="area-to-the-right-of-x">
<span class="header-section-number">5.3</span> 3. Area to the right of <span class="math inline">\(x\)</span>
</h3>
<p>The probability to the right of <span class="math inline">\(x\)</span> is one minus the probability to the left of <span class="math inline">\(x\)</span>: <span class="math display">\[
P(X &gt; x) = 1 - P(X &lt; x)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/pnorm_right.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="the-inverse-problem-quantiles-and-percentiles" class="level2" data-number="6"><h2 data-number="6" class="anchored" data-anchor-id="the-inverse-problem-quantiles-and-percentiles">
<span class="header-section-number">6</span> The inverse problem: quantiles and percentiles</h2>
<p>In this section we will examine the inverse problem to the one of calculating the probability that <span class="math inline">\(X &lt; x\)</span>.</p>
<p>Given a probability <span class="math inline">\(p\)</span>, what’s the value <span class="math inline">\(x\)</span> that cuts to its left a probability of <span class="math inline">\(p\)</span>?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/prob/normal_quantile.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
<p>That value, called the <em><strong><span class="math inline">\(p\)</span>-quantile</strong></em>, is the value <span class="math inline">\(x_p\)</span> for which the lower-tail probability is <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
\text{value }x_p\text{ such that} \qquad P(X \leq x_p) = p
\]</span></p>
<p>Percentiles and quantiles are two words used to express the same idea. We use <em><strong>percentile</strong></em> when speaking in terms of percentages and <em><strong>quantile</strong></em> when speaking in terms of proportions (or probabilities) between 0 and 1.</p>
<p>The 50th percentile (or <span class="math inline">\(0.5\)</span>-quantile) is the value <span class="math inline">\(x_{0.5}\)</span> that cuts a 0.5 probability to its left. You actually know that the value such that 50% of the observations are lower and 50% are higher is called the median.</p>
<p><br> In R, you calculate the <span class="math inline">\(p\)</span>-quantile with the function</p>
<pre><code>qnorm(p, mean, sd)</code></pre>
<p>This will return the value <span class="math inline">\(x\)</span> such that <span class="math inline">\(P(X \leq x) = p\)</span>. That value is typically written <span class="math inline">\(x_p\)</span>.</p>
<p><br> For example, if <span class="math inline">\(X \sim N(0, 1)\)</span>, the value cutting an area of 0.025 to its left is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.959964</code></pre>
</div>
</div>
<p>while that cutting an area of 0.975 to its left is</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
</div>
<p>The <span class="math inline">\(0.025\)</span>-quantile is <span class="math inline">\(x_{0.025} = -1.96\)</span>, and the <span class="math inline">\(0.975\)</span>-quantile is <span class="math inline">\(x_{0.975} = 1.96\)</span>.</p>
</section><section id="working-in-standard-units" class="level2" data-number="7"><h2 data-number="7" class="anchored" data-anchor-id="working-in-standard-units">
<span class="header-section-number">7</span> Working in standard units</h2>
<p>Instead of always specifying the mean and the standard deviation of the normal distribution, we can work with a reference normal distribution that has a mean equal to 0 and standard deviation equal to 1. This is known as the <strong>standard normal distribution</strong>.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Standard normal distribution</strong></p>
<p>The standard normal distribution, denoted <span class="math inline">\(Z \sim N(0, 1)\)</span>, is a normal distribution with mean = 0 and standard deviation = 1.</p>
</div>
</div>
</div>
<p>The R functions <code>dnorm(x, mean, sd)</code> and <code>pnorm(x, mean, sd)</code> assume that mean = 0 and sd = 1 if not provided. In other words, they assume a standard normal distribution by default.</p>
<p>For example, the following two functions return the same output</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05399097</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">2</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05399097</code></pre>
</div>
</div>
<p>and similarly for <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code>.</p>
<p>In order to transform a value <span class="math inline">\(x\)</span> from a normal distribution with mean = <span class="math inline">\(\mu\)</span> and sd = <span class="math inline">\(\sigma\)</span> to a score on the standard normal scale, we must use the z-score transformation.</p>
<p>The z-score measures distance in terms of the number of standard deviations from the mean: <span class="math display">\[
z = \frac{x - \mu}{\sigma} \qquad (\text{standard units or } z\text{-}scores)
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>z-score</strong></p>
<p>The z-score of <span class="math inline">\(x\)</span> is the number of standard deviations <span class="math inline">\(x\)</span> is from the mean.</p>
</div>
</div>
</div>
<p><br></p>
<p>Let <span class="math inline">\(X \sim N(\mu, \sigma)\)</span> and <span class="math inline">\(Z \sim N(0, 1)\)</span>. The following relation holds: <span class="math display">\[
P(X &lt; x) = P \left( \frac{X - \mu}{\sigma} &lt; \frac{x - \mu}{\sigma} \right) = P(Z &lt; z)
\]</span></p>
<p>This means that the probability, when computed on the original normal distribution or on the standard normal distribution, will be the same as long as you use the z-score of <span class="math inline">\(x\)</span> for the standard normal distribution.</p>
<p><br></p>
<p>Consider the following cases:</p>
<ol type="a">
<li>You observe <span class="math inline">\(x = 4.3\)</span> from a <span class="math inline">\(N(3, 2)\)</span> distribution. The z-score is <span class="math inline">\(z = (4.3 - 3) / 2 = 0.65\)</span>
</li>
<li>You observe <span class="math inline">\(x = 4.3\)</span> from a <span class="math inline">\(N(3, 0.2)\)</span> distribution. The z-score is <span class="math inline">\(z = (4.3 - 3) / 0.2 = 6.5\)</span>
</li>
</ol>
<p>In case (a), your observed value 4.3 is 0.65 standard deviations away from the mean. In case (b), the observed value 4.3 is 6.5 standard deviations away from the mean.</p>
<p>Observing a value of 4.3 from a <span class="math inline">\(N(3,2)\)</span> population is very likely, as 68% of the observations are within 1 <span class="math inline">\(\sigma\)</span> of the mean. However, observing a value of 4.3 from a <span class="math inline">\(N(3,0.2)\)</span> distribution is very unlikely, as almost all the values will be within 3 <span class="math inline">\(\sigma\)</span> of the mean. Such a high z-score provides us with an element of surprise. We might want to inspect that value further as it could be an outlier or a typing error of who has entered the data.</p>
<p>As you can see, z-scores are particularly useful for comparing observations across distributions having a different mean and standard deviation.</p>
</section><section id="summary" class="level2" data-number="8"><h2 data-number="8" class="anchored" data-anchor-id="summary">
<span class="header-section-number">8</span> Summary</h2>
<p>When a histogram shows that a variable’s distribution is symmetric and bell-shaped, we can say that the variable is normally distributed and we can model the distribution with a mathematical curve called the normal density function.</p>
<p>We saw that the normal distribution depends on two parameters that control the centre and spread of the normal density curve:</p>
<ul>
<li>the mean;</li>
<li>the standard deviation.</li>
</ul>
<p>These two parameters make sure that the normal curve can fit histograms that have different centres and spreads.</p>
<p>In other words, if you know that a distribution is normal (shape), then the mean (centre) and standard deviation (spread) tell you everything else about the distribution.</p>
<p>In R, the equation of the normal density curve is given by the function <code>dnorm(x, mean, sd)</code>.</p>
<p>We can use the normal curve to compute the probability of intervals as the area under the curve in that interval. The function to compute the area under a normal curve to the left of <code>x</code> is <code>pnorm(x, mean, sd)</code>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 54%">
<col style="width: 45%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Probability</th>
<th style="text-align: left;">R command</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Probability of observing a value less than or equal <code>x</code>
</td>
<td style="text-align: left;"><code>pnorm(x, mean, sd)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Probability of observing a value between <code>xl</code> and <code>xu</code>
</td>
<td style="text-align: left;"><code>pnorm(xu, mean, sd) - pnorm(xl, mean, sd)</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Probability of observing a value greater than <code>xu</code>
</td>
<td style="text-align: left;"><code>1 - pnorm(xu, mean, sd)</code></td>
</tr>
</tbody>
</table>
<p>The value <span class="math inline">\(x_p\)</span> cutting an area = <span class="math inline">\(p\)</span> to its left is returned by <code>qnorm(p, mean, sd)</code>. This is called the <span class="math inline">\(p\)</span>-quantile of <span class="math inline">\(X\)</span>.</p>
</section><section id="glossary" class="level2" data-number="9"><h2 data-number="9" class="anchored" data-anchor-id="glossary">
<span class="header-section-number">9</span> Glossary</h2>
<ul>
<li>
<strong>Continuous random variable.</strong> A variable that takes on numerical values determined by a chance process which can have any number of decimals.</li>
<li>
<strong>Density function.</strong> The function which provides the probability that a random variable is within an interval in terms of the area under that curve between that interval.</li>
<li>
<strong>Normal distribution.</strong> The probability distribution of a random variable which has a symmetric and bell shaped density curve.</li>
<li>
<span class="math inline">\(p\)</span>-<strong>quantile.</strong> The <span class="math inline">\(x_p\)</span> value cutting an area = <span class="math inline">\(p\)</span> to its left. In other words, the <span class="math inline">\(x_p\)</span> value such that <span class="math inline">\(P(X \leq x_p) = p\)</span>.</li>
</ul>


</section><a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2019-2024 <a href="https://www.ed.ac.uk/">The University of Edinburgh</a>. Site licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">GNU AGPLv3</a> license.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>